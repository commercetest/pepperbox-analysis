# CommerceTest PepperBox Analysis Tool

## What is this?
This tool processes files generated by [Commerce Test Pepper Box](https://github.com/commercetest/pepper-box) Consumers (.csv).


## Why?
The purpose of this tool is to generate useful, Excel-able, graphable data from million+ row CSV files

## How?
The script index.js expects `in` and `out` directories in the root of this project.
The `in` directory should contain one directory for each batch of test results from pepper-box. Within the test folder should be the outputted CSV files.
```
in/
    tps=10-threads=3-duration=20-topicname=my-topic/
        11-28_22-03-18__UTC/
            iostat-host.json
            consume_mps_at.10.log
            produce_mps_as.10.log
            pblg.properties
            results-mps.1.0.of[0..2].csv
            results-mps.1.1.of[0..2].csv
            ...
```

After running `node index.js`, you should see something like the following:
```
out/
    tps=10-threads=3-duration=20-topicname=my-topic/
        11-28_22-03-18__UTC/
            iostat-hostname-date.csv
            sampled-results-mps-10.csv
            sampled-results.combined.csv
```

`*.combined.csv` - Combined and sorted based on mps value in filename

`sampled-*.csv` - Combined files sampled by seconds, using the middle 50%

## Using the data
This pre-processing is designed to make it easier to play with and graph data.
There is a sample Excel file in this project which demonstrates the kinds of visualisations and insights one can draw from this data.

### To Run
```bash
> npm install # install dependencies
> rm -rf out/*
> rm -rf in/*
> ./runTestRunner.sh
> node index.js
> ls -la out/
```